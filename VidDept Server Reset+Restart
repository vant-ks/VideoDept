#!/usr/bin/osascript

# Video Production Manager - Reset & Restart (AppleScript)
# Runs silently without opening Terminal windows

do shell script "
cd '/Users/kevin/Dropbox (Personal)/Development/VideoDept/VideoDept/video-production-manager'

# Kill any running servers
pkill -f 'vite' 2>/dev/null
pkill -f 'node.*vite' 2>/dev/null
pkill -f 'tsx.*server.ts' 2>/dev/null
lsof -ti:3011 | xargs kill -9 2>/dev/null
lsof -ti:3010 | xargs kill -9 2>/dev/null
sleep 1

# Start API server in background
cd api
nohup npm run dev > /dev/null 2>&1 &
cd ..

# Start frontend dev server in background
nohup npm run dev > /dev/null 2>&1 &

# Wait for servers to be ready
sleep 5
"

# Open reset page in browser
tell application "System Events"
	open location "http://localhost:3011/reset-settings.html"
end tell
