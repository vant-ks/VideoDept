#!/bin/bash

# Video Production Manager - Reset & Restart Script
# This script clears localStorage and restarts the development server

echo "ðŸ”„ Video Production Manager - Reset & Restart"
echo "=============================================="
echo ""

# Navigate to project directory
PROJECT_DIR="/Users/kevin/Dropbox (Personal)/Development/VideoDept/VideoDept/video-production-manager"
cd "$PROJECT_DIR" || { echo "âŒ Failed to navigate to project directory"; exit 1; }

# Kill any running Vite servers
echo "ðŸ›‘ Stopping running servers..."
pkill -f 'vite' 2>/dev/null
sleep 2

# Clear browser localStorage using AppleScript (opens browser to reset page)
echo "ðŸ§¹ Opening reset page in browser..."
open "http://localhost:3000/reset-settings.html" 2>/dev/null &

# Wait for reset page to load
sleep 3

# Start the dev server in a new terminal that will stay open
echo "ðŸš€ Starting development server in new terminal..."
echo ""
echo "âœ… Server will start in a new terminal window"
echo "This window will close in 2 seconds..."
sleep 2

# Open new terminal with dev server using full hardcoded path
osascript <<'APPLESCRIPT'
tell application "Terminal"
    do script "cd '/Users/kevin/Dropbox (Personal)/Development/VideoDept/VideoDept/video-production-manager' && npm run dev"
    activate
end tell
APPLESCRIPT

# Close this terminal window after a delay
sleep 1
exit 0
